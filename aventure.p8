pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--jeu d'aventure
--nadege

function _init()
	create_player()
end

function _update()
	player_movement()
	update_camera()
end

function _draw()
	cls()
	draw_map()
	draw_player()
	draw_ui()
end
-->8
--map

function draw_map()
	map(0,0,0,0)
end

function check_flag(flag,x,y)
 local sprite=mget(x,y)
	return	fget(sprite,flag)
end

function update_camera()
	camx=mid(0,p.x-7.5,127-15)
	camy=mid(0,p.y-7.5,32-15)
	camera(camx*8,camy*8)
end

function next_tile(x,y)
	sprite=mget(x,y)
	mset(x,y,sprite+1)
end

function pick_up_key(x,y)
	next_tile(x,y)
	p.keys+=1
	sfx(0)
end

function open_door(x,y)
	next_tile(x,y)
	p.keys-=1
	sfx(1)
end

function old_camera()
	camx=flr(p.x/16)*16
	camy=flr(p.y/16)*16
	camera(camx*8,camy*8)
end
-->8
--player

function create_player()
	p={
	x=6,
	y=4,
	sprite=9,
	keys=0
	}
end

function player_movement()
	newx=p.x
	newy=p.y
	if (btnp(➡️)) newx+=1
	if (btnp(⬅️)) newx-=1
	if (btnp(⬇️)) newy+=1
	if (btnp(⬆️)) newy-=1
	
	interact(newx,newy)
	
	if not check_flag(0,newx,newy) then
		p.x=newx
		p.y=newy
	if (p.x<0) p.x=0
	if (p.y<0) p.y=0
	if (p.x>127) p.x=127
	if (p.y>32) p.y=32
	end
end

function interact(x,y)
	if check_flag(1,x,y) then
		pick_up_key(x,y)
	elseif check_flag(2,x,y)
	and p.keys>0 then
		open_door(x,y)
	end
end

function draw_player()
	spr(p.sprite,p.x*8,p.y*8)
end
-->8
--ui

function draw_ui()
	camera(0,0)
	palt(0,false)
	palt(12,true)
	spr(22,2,2)
	palt()
	print_outline("X"..p.keys,10,2)
end

function print_outline(text,x,y)
	 print(text,x-1,y,0)
	 print(text,x+1,y,0)
	 print(text,x,y-1,0)
	 print(text,x,y+1,0)
		print(text,x,y,7)
end
__gfx__
0000000033333333333333333333333333bbbb3311111111444444444444444433333333077777003333333300000000ddddddddffffffff0000000000000000
000000003333333333a33333333337333bbaabb311111111444444444ffffff433333333777747703bb3333300000000ddddddddfdfdfdff0000000000000000
00700700333333333a9a3333333379733bbbab1311111111dddddddd4f444f44333333a37484487033bb33b300000000ddddddddffffffff0000000000000000
000770003333333333a33333333337333bbbbd1311111111cccccccc4ffffff4aaaaaa3a77444470333b3bb300000000dddddddddfdfdfdf0000000000000000
000770003333333333333a333373333331dbdd1311111111111111114444f444a33333a37722227033333bb300000000ddddddddffffffff0000000000000000
00700700333333333333a9a3379733333311113311111111111111114ffffff4333333330211110033333b3300000000ddddddddfdfdfdfd0000000000000000
000000003333333333333a3333733333333223331111111111111111444444443333333302ffff003333333300000000ddddddddffffffff0000000000000000
000000003333333333333333333333333314423311111111111111114ffffff433333333021001003333333300000000dddddddddfdfdfdf0000000000000000
dddddadddddddddd33333a33333333330444444014420001cccccccc000000000000000000000000000000000000000000000000000000000000000000000000
daaaadaddddddddd3aaaa3a3333333334405050444520000ccccc0cc000000000000000000000000000000000000000000000000000000000000000000000000
5a555a55555555555a555a55555555559405050495520000c0000a0c000000000000000000000000000000000000000000000000000000000000000000000000
4455554444555544445555444455554494444444954200000aaaa0a0000000000000000000000000000000000000000000000000000000000000000000000000
dd4444dddd4444dd334444333344443344444414444200000a000a0c000000000000000000000000000000000000000000000000000000000000000000000000
ddd44dddddd44ddd33344333333443339444446494420000c0ccc0cc000000000000000000000000000000000000000000000000000000000000000000000000
d544445dd544445d35444453354444539424444494200000cccccccc000000000000000000000000000000000000000000000000000000000000000000000000
d555555dd555555d35555553355555534224242442000000cccccccc000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d0d0d0d0d0d0d0d0d0d0d010101010101010104010104010101010101010101010101010d0d0d0d0d0d0d0d0d0d0d0d0d0d01010101010101010101010101010
1010101010101010101010101010101010101010101010101010101040101010101010101010404010401010101010101010d0d0d0d0d0d0d0d0d0d0d0d0d0d0
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d0d0
__gff__
0000000001010100000000010001010002010201050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0404040401040404040404040101010101010101010104040404040404120404040401010101010101010103010101010101040404040404040101010101010404040404040101010101010101010101010101010101010101010101040404040404040404040404040404040101010101010101010404040404040404040404
04040404010104040401010101010101010101010101010104040404040101040404040404040401010101010101010101010101010101010101040404040404040404040401010104040404040404010101010101010a0101010101010104040404040404040404040404010112010404040404040404040404040404040404
04040404040101010101010a0101010101010101010101010101040404040104040404040404010101010101010101010101010101010104040404040404040404040404040112010404040404040101010101010101010101010101010101010104040404040404010101010404040404040404040404040404040404040404
0404040404040101010101010101010101010101010201010101010101010104040404040401010101010101010101010a01010101010101040404040404040404040404010101040404040401010101010101010101010103010101010101010101040404040101010404040404040404040404040404040404040404040401
01040404040101010101010101010101010101010101010101010101040404040404040401010101010101010101010101010101010101010104040404040404040404010104040404040401010101010101010a0101010101010101010101010101010104010104040404040404040404040404040404040404040404040112
0104040401010101010101010101010101010101010101010101010101040404040404040101010a01010101010101010101010101010101010104040404040404040101040404040404010101010101010101010101010101010101010101010101010101010104040404040404040401010101010101010104040404040101
0104040401010101010101010101030301010101010101010101010101040404040404010101010101010102010101010101010103010101010101040404040404010104040404040401010101010101010101010101010101010101010a01010101010101010101010404040404040101010101010101010104040404010104
010404010101010101010101010101010101010101010101010101010101040404040101010101010101020101010101010101010301010101010104040404010101040404040404010101010101010a010101010101010101010101010101010101010101010101010104040401010101010101010101010101040404010104
01040101010101010101010101010101010101010101010101010101010104040404010101010101010101010101010101010101010101010101010104040101010404040104040101010101010101010101010101010101010101010101010101010101010101010101010101010103010101010a0101010101010404010404
0101010101010101010101010101010101010101010101010101010101010104040101010101010101010101010101010a010101010101010101010104040101040404010104040101010101010101010101010101010101010d0d0d0d0d0d0d0d0d0d0d01010101010101010101010101010101010101010101010101010404
01010101010101010101010101010101010101010102010101010101010101040101010101010101010101010101010101010101010101010101010101010104040404010404010101010101010101010101010101010101010d0c0c0c0c0c0c0c0c0c0d0101010d0d0d0d0d0101010101010101010101010101010101040404
01010101010101010101010101010101010101010201010101010101010101010101010101010a0101010101010101010101010101010101010a010101010404040404010401010101010a0101010101010202010101010101140c0c0c0c0c0c0c0c0c0d0101010d0c0c0c0d0d0d0d0d01010101010101010101010101040404
010101010a010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a010101010101010104040404010101010101010101010101010101030101010101010d0d0d0d0d0d0d0d0c0c0d0101010d0c0c0c0c0c0c0c0d01010101010101010101010101040404
0101010101010101010101010101010101010101010101010101010101010101010101010101010101010606060601010101010101010101010101010101010101040404010101010101010101010101010101010101010101010101010101010d0c0c0d0101010d0c0c0d0d0d0c0c0d01010101010101010101010101010404
010101060606060607060606060606010101010101010101010a010101010101010101010101010606060505050506060101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010d0c0c0d0101010d0c0c0d010d0c0c0d0d010106060606010101010101010104
0606060505050505070505050505050601010101010101010101010101010101010101010106060505050101010505050601010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010d0c0c0d0101010d0c0c0d010d0c0c0c0d010605050505060606060101010101
0505050501010101010101010101050506010101010101010101010101010101010101060605050501010101010101050507060606010101010101010a01010101010101010101010101010101010101010101010101010101010103010101010d0c0c0d0101010d0c0c0d010d0d0d0c0d010505010105050505050601010101
010101010101010101010101010101050506010101010101010101010101010101060705050501010101010a010101010507050505060601010101010101010101010101010101010101010101010101010101010101010101010101010101010d0c0c0d0104040d0c0c0d0101010d0c0d060501010101010101050506010101
01010101010101010101010101010101050501010101010101010101010101010605070501010101010101010101010101010101050505060601010101010101010101010101010101010a0101010101010101010101010101010101010101010d0c0c0d0104040d0c0c0d0101010d0c0d05050d0d0d01010101010505060606
010101010301010101010101010101010105010101010101010101010101060605050101010101010d0d0d0d0d0d01010101010104010505050601010101010101010101010101010101010101010106060606060601010101010101010101010d0c0c0d0d0d0d0d0c0c0d0101010d0c0c070c0c0c0d01010101010105050505
010103010101010101010a01010101010105060101010102010101010606050505010101010d0d0d0d0c0c0c0c0d0d0d0d01010104040101050506010101010101010101030101010101010101060605050505050507060101010101010101010d0c0c0c0c0c0c0c0c0c0d0101010d0d0d050d0c0c0d0d0d0d0d0d0101010101
0101010101010101010101010101010101050506060101010101010605050501010101010d0d0c0c0c0c0c0c0c0c0c0c0d0d0d0404010101010505010101010101010103010101010101010101050505010101010507050606060606010101010d0c0c0c0c0c0c0c0c0c0d010104040406050d0c0c0c0c0c0c0c0d0d0d0d0d0d
01010101010101010101010101010101010105050506060606060605050101010101010d0c0c0c0d0d0d0d0d0d0d0d0c0c0c0d0d04010101010105060101010101010101010101010101010106050101010101010101050505050505060101010d0d0d0d0d0d0d0d0d0d0d010101040405050d0d0d0d0d0c0c0c0c0c0c0c0c0c
0d0d0d0d0d0d0d0d0d140d0101010101010101040505050505050505010101010101010d0c0c0d0d0c0c0c0c0c0c0d0d0c0c0c0d01010101010105050101010101010101010101010101010605010101010101010a0101010101040505060601010101010101010101010101010101060501010101010d0c0c0c0c0c0c0c0c0d
0c0c0c0c0c0c0c0c0c0c0d01010101010104010401010101010101010101010101010d0d0c0d0d0c0c0c0c0c0c0c0c0d0d0c0c0c0d010101010101050601010101010101010101010101010505010101010101010101010101010404050505060606060606010101010101010106060505010d0d0d0d0d0c0c0d0d0d0d0d0d0d
0c0d0d0d0d0d0d0d0d0d0d01010101010101010104010101010401040101010101010d0c0c0d0c0c0c0d0d0d0d0c0c0c0d0c0c0c0d01010a010101050506060601010101010106060606060501010101010101010101010101010104010105050505050505060606070606060605050501040d0c0c0c0c0c0c0c0c0c0d0c0c0c
0c0c0c0c0c0c0c0c0c0c0d0101010101010104010112010a010101010101040101010d0c0c0d0c0c0d0d0c0c0d0c0c0c0d0c0c0d01010101010101010105050506060706060605050505050101010101010101010101010101010401040101010101010105050505070505050505010101010d0c0c0d0d0d0c0c0d0c0d0c0c0c
0d0d0d0d0d0d0d0c0c0c0d01010101010101010104010401010104010101010101010d0c0c0d0c0c0d0c0c0c0c0c0c0c0d0c0c0d01010101010101010101010505050705050505010404010101010101010101010101020101010101010101010101010101010101010101010101010101040d0c0c0c0c0d0d0d0d0c0d0c100c
0c0c0c0c0c0c0c0c0c0c0d0101010101010101010101010101010101010101010101140c0d0d0c0c0d0c0c0c0c0c0c0d0d0c0d0d01010a01010101010101010101010101040401040104010101010101010a01010101010101010101040101010101010101010101010101010101010101010d0c0c0c0c0c0c0c0c0c0d0c0c0c
0c0c0c0c0c0c0c0c0c0c0d0101010a010104010101010104010401010401010101010d0d0d0d0c0c0d0c100c0c0d0d0d0c0c0d010101010101010a010101010101010101010404011204010101010101010101010101010101010101010101010101010101010101010101010101010101010d0d0d0d0d0c0c0d0c0c0d0c0c0c
0c0c0c0d0d0d0d0d0d0d0d0101010101010101040104010401010101010101010101010d0d0d0c0c0d0d0d0d0d0d0c0c0c0d0d0101010a010101010101010101010101010101040101040101010101010101010201010101010a0101010101020102010101010101010401010a01010101010d0c0c0c0c0c0c0d0c0c0d0c0c0c
0c100c0c0c0c0c0c0c0c0d010101010101040101010101010104010104010a01010101010d0d0c0c0c0c0c0c0c0c0c0c0d0d0101010101010101010101010101010a0101010101010401010101010101010101010101010101010101010101010101010101010104040101010101010101010d0c100c0c0c0c0d0c0c0c0c0c0c
__sfx__
00050000260502405020050000002b050300503305000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000e00000d65025650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
