pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--variable

function _init()
	player={
									sp=32,
									x=59,
									y=59,
									w=8,
									h=8,
									flp=false,
									dx=0,
									dy=0,
									max_dx=33,
									max_dy=34,
									acc=0.5,
									boost=4,
									anim=0,
									running=false,
									jumping=false,
									falling=false,
									sliding=false,
									landed=false
						}
						
						gravity=0.3
						friction=0.85
end




-->8
--update and draw
function _update()
		player_update()
	--	player_animate()
end
		
function _draw()
		cls()
		map(0,0)
		spr(player.sp,player.x,player.y,1,1,player.flp)
end
-->8
--collistions

function collide_map(obj,aim,flag)
	--obj = table needs x,y,w,h
	--aim = leftnright,up,down

	
	local x=obj.x local y=obj.y
	local w=obj.w local h=obj.h
	
	local x1=0 local y1=0
	local x2=0 local y2=0
	
	if aim=="left" then
			x1=x-1 y1=y
			x2=x   y2=y+h-1
			
	elseif aim=="right" then
			x1=x+w    y1=y
			x2=x+w+1  y2=y+h-1
			
	elseif aim=="up" then 
			x1=x+1    y1=y-1
			x2=x+w-1  y2=y
			
	elseif aim=="down" then
			x1=x      y1=y+h
			x2=x+w    y2=y+h
	end
	
	--pixels to titles
	x1/=8    y1/=8
	x2/=8    y2/=8
	
	if fget(mget(x1,y1), flag)
	or fget(mget(x1,y2), flag)
	or fget(mget(x2,y1), flag)
	or fget(mget(x2,y2), flag) then
	    return true
	else
	    return false
	end
	  
end
-->8
--player

function player_update()
		--physics
		player.dy+=gravity
		player.dx*=friction
		
		--controls
		if btn(⬅️) then
				player.dx-=player.acc
				player.running=true
				player.flp=true
		end
		if btn(➡️) then
				player.dx+=player.acc
				player.running=true
				player.flp=false
		end
		
		--slide
		if player.running
		and not btn(⬅️)
		and not btn(➡️)
		and not player.falling
		and not player.jumping then
		  player.running=false
		  player.sliding=true
		end
		
		--jump
		if btnp(❎)
		and player.landed then
				player.dy-=player.boost
				player.landed=false
		end
		
		--check collision up and down
		if player.dy>0 then
				player.falling=true
				player.landed=false
				player.jumping=false
				
				if collide_map(player,"down",0) then
				  player.landed=true
				  player.falling=false
				  player.dy=0
				  player.y-=(player.y+player.h)%8
				end
		elseif player.dy<0 then
		  player.jumping=true
		  if collide_map(player,"up",1) then
		    player.dy=0
		  end		  	
		end
		
--check player collision left and right
  if player.dx<0 then
    if collide_map(player,"left",1) then
      player.dx=0
    end
  elseif player.dx>0 then
    if collide_map(player,"right",1) then
      player.dx=0
    end
  end
  
  --stop sliding
  if player.sliding then
  		if abs(player.dx)<.2
  		or player.running then
  		  player.dx=0
  		  player.sliding=false
  		end
  end  
		
		player.x+=player.dx
		player.y+=player.dy
		
		
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00150150001501500015015000150150001501500015015000550550005505500055055000000000000000000000000000000000000000000000000000000000
00555550005555500015555500155555001555550015555501155555011555550115555515515500000000000000000000000000000000000000000000000000
00573530005735300055573500555735005557350055573500555735505557350055573515555500000000000000000000000000000000000000000000000000
00555f5000555f500005555f0005555f0005555f0005555f5005555f0505555f5005555f05735300000000000000000000000000000000000000000000000000
000550000c0550c00c5550000055510001155000001555000505511011555110150550000555f500000000000000000000000000000000000000000000000000
00555500005555000005510000c5510000055c0000155c00005555c0c55555c0c155510000555110000000000000000000000000000000000000000000000000
0c0510c0000510000c5010000005100001105000000150000155500000000000055555100c055100000000000000000000000000000000000000000000000000
000c1000000c1000000010000005100000005000000150001c00000000000000000000c000005511000000000000000000000000000000000000000000000000
0000500000006060000000005dd5d66d098909898884949844555444585585850098900000980000000444444444444444440000000000000000000000000000
00084000066686860000000056666666009808908459498888444480454545540098800000088000004888888888888888844400000000000000000000000000
000845006860606000000000566655d609800089899488850884888044d444440099890000098000048899999999999999888444000000000000000000000000
0048840066668660000000005666666504840484954884990988890045445d450000890000008900488995555555555559999888000000000000000000000000
054484506886668600000000565dd66548584858488599940998900044d844440000890000009000889955445445d45445599998000000000000000000000000
0444884006860860000000005555566d854585458849945800980000844544850098890000090000899544d44548454d4d455559000000000000000000000000
5444484500888800000000005dd666665444544485994588000890004484445400980000009800009955454dd454445454544d55000000000000000000000000
4444484400688600000000005555555544444444549458840098000045445844000890000009000055d4d455844d844844d454d4000000000000000000000000
5444484506886860000000005dd66666544454448495888900989000454444440008990000098000000000000000000000000000000000000000000000000000
44444484006886000000000055555555444444444998859400980000f44f544f0098000000009000000000000000000000000000000000000000000000000000
00000000ac436211e3ec00967df1276995c4d047f48557d700000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000010000000000000101010101010001020200000000000101000001000000000000000000000000010101010000000100000003000003030301000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
3737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737373737000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000363600000000000000000000000000000036000000000000000000003600000000000000000000000000360000000000000000000000000000000036000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000393800000000000000000000000000000038000000000000000000003800000000000000000000000000380000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000003900000100000000000000000000000039000000000000000000003900000000000000000000000000380000000000000000000000000000000039000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000390000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a3b3c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000003a3b3c00000000000000000000000000000000000031000000000000000000003a3737373c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000003a3737373c0000000000000000000000000000000000300000000000000000003a37373737373c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333434343333333333333333333333333333333333333333333333333333333333333335353533333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000b02000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
